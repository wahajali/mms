<%= bootstrap_nested_form_for [@patient, @patient_record], :html => { :class => "form-horizontal patient_record" } do |f| %>

    <% if @patient_record.errors.any? %>
    <div id="error_expl" class="panel panel-danger">
      <div class="panel-heading">
        <h3 class="panel-title"><%= pluralize(@patient_record.errors.count, "error") %> prohibited this patient_record from being saved:</h3>
      </div>
      <div class="panel-body">
        <ul>
        <% @patient_record.errors.full_messages.each do |msg| %>
          <li><%= msg %></li>
        <% end %>
        </ul>
      </div>
    </div>
  <% end %>

  <%= f.date_field :visit_date_english, :value => Date.today %>
  <%= f.collection_select(:doctor_id, Doctor.all, :id, :name, {label: 'Attending Doctor', :prompt => true}) %>
  <%= f.collection_select(:disease_id, Disease.all, :id, :name, {label: 'Diagnosed Disease', :prompt => true}) %>
  <%= f.select(:visit_day, [["Monday", "Monday"], ["Tueday", "Tueday"], ["Wednesday", "Wednesday"], ["Thursday", "Thursday"], ["Friday", "Friday"], ["Saturday", "Saturday"], ["Sunday", "Sunday"]]) %>
  <%= f.text_field :handling_person %>
  <%= f.hidden_field :patient_id, value: @patient.id %>
  <%= f.number_field :checked_weight %>
  <%= f.number_field :checked_height %>
  <%= f.number_field :checked_bp %>
  <%= f.number_field :no_of_children %>
  <%= f.number_field :youngest_child_age %>
  <%= f.text_field :lscs %>
  <%= f.text_field :diabetic_history %>
  <%= f.text_area :present_complaint %>
  <%= f.text_area :conducted_physical_examination %>
  <% f.fields_for :prescriptions do |b| %>
    <div class='prescription'>
    <%= b.static_control :medication_type, label: { text: "Medicine Type: " } do %>
      <%= check_box_tag(:homeopathy) %>
      <%= label_tag(:hemeopathy, "Hemeopathic Medications") %>
      <%= check_box_tag(:herbal) %>
      <%= label_tag(:herbal, "Herbal Medications") %>
      <%= check_box_tag(:allopathic) %>
      <%= label_tag(:allopathic, "Allopathic Medications") %>
    <% end %>
    <%= b.select :medicine_id, options_for_select(@medicines.map{ |c| [c.display_name, c.id, {'data-medicine-id' => c.id}] }) %>
    <%#= b.collection_select(:medicine_id, @medicines, :id, :display_name, {label: 'Prescribed Medicines'}, {id: 'prescribed-medicine'}) %>
    <%= b.number_field :morning_quantity, { style: 'width:70px; display: block;', value: 0 } %>
    <%= b.number_field :afternoon_quantity, { style: 'width:70px; display: block;', value: 0 } %>
    <%= b.number_field :evening_quantity, { style: 'width:70px; display: block;', value: 0 } %>
    <%= b.link_to_remove "Remove this prescription" %>
    </div>
  <% end %>
  <%= f.link_to_add "Add a prescription", :prescriptions %></br></br>

  <%#= f.collection_select(:medicine_ids, @medicine_homeo, :id, :name, {label: 'Prescribed Homeo Medicines'}, {id: 'prescribed-medicine-homeo'}) %>

  <%= f.submit nil, :class => 'btn btn-primary' %>
  <%= link_to t('.cancel', :default => t("helpers.links.cancel")),
    patient_path(@patient), :class => 'btn btn-default' %>

  <% end %>
