<%- model_class = Patient -%>
<div class="page-header">
  <h1><%=t '.title', :default => model_class.model_name.human.titleize %></h1>
</div>

<dl class="dl-horizontal">
  <dt><strong><%= model_class.human_attribute_name(:card_no) %>:</strong></dt>
  <dd><%= @patient.card_no %></dd>
  <dt><strong><%= model_class.human_attribute_name(:card_date) %>:</strong></dt>
  <dd><%= @patient.card_date %></dd>
  <dt><strong><%= model_class.human_attribute_name(:first_name) %>:</strong></dt>
  <dd><%= @patient.first_name %></dd>
  <dt><strong><%= model_class.human_attribute_name(:last_name) %>:</strong></dt>
  <dd><%= @patient.last_name %></dd>
  <dt><strong><%= model_class.human_attribute_name(:fathers_name) %>:</strong></dt>
  <dd><%= @patient.fathers_name %></dd>
  <dt><strong><%= model_class.human_attribute_name(:mothers_name) %>:</strong></dt>
  <dd><%= @patient.mothers_name %></dd>
  <dt><strong><%= model_class.human_attribute_name(:husbands_name) %>:</strong></dt>
  <dd><%= @patient.husbands_name %></dd>
  <dt><strong><%= model_class.human_attribute_name(:dob) %>:</strong></dt>
  <dd><%= @patient.dob %></dd>
  <dt><strong><%= model_class.human_attribute_name(:referred_by) %>:</strong></dt>
  <dd><%= @patient.referred_by %></dd>
  <dt><strong><%= model_class.human_attribute_name(:gender) %>:</strong></dt>
  <dd><%= @patient.gender %></dd>
  <dt><strong><%= model_class.human_attribute_name(:marital_status) %>:</strong></dt>
  <dd><%= @patient.marital_status %></dd>
  <dt><strong><%= model_class.human_attribute_name(:blood_group) %>:</strong></dt>
  <dd><%= @patient.blood_group %></dd>
  <dt><strong><%= model_class.human_attribute_name(:patient_type) %>:</strong></dt>
  <dd><%= @patient.patient_type %></dd>
  <dt><strong><%= model_class.human_attribute_name(:financial_type) %>:</strong></dt>
  <dd><%= @patient.financial_type %></dd>
  <dt><strong><%= model_class.human_attribute_name(:treatment_type) %>:</strong></dt>
  <dd><%= @patient.treatment_type %></dd>
  <dt><strong><%= model_class.human_attribute_name(:previous_illnesses) %>:</strong></dt>
  <% @patient.previous_diseases.each do |i| %>
    <dd><%= i.name %></dd>
  <% end %>
  <dt><strong><%= model_class.human_attribute_name(:family_history) %>:</strong></dt>
  <% @patient.family_history_diseases.each do |i| %>
    <dd><%= i.name %></dd>
  <% end %>
</dl>

<% if @patient_records.any? %>
  <%- model_class = PatientRecord -%>

  <div class="page-header">
    <h3><%=t '.title', :default => 'Treatment History' %></h3>
  </div>

  <table class="table table-striped">
    <thead>
      <tr>
        <th><%= model_class.human_attribute_name(:visit_date) %></th>
        <th><%= 'Doctors Name' %></th>
        <th><%= model_class.human_attribute_name(:handling_person) %></th>
        <th><%=t '.actions', :default => t("helpers.actions") %></th>
      </tr>
    </thead>
    <tbody>
      <% @patient_records.each do |patient_record| %>
        <tr>
          <td><%= patient_record.visit_date_english %></td>
          <td><%= link_to_if(patient_record.doctor.present?, patient_record.doctor.try(:name), patient_record.doctor)  %></td>
          <td><%#= link_to patient_record.id, patient_patient_record_path(@patient, patient_record) %></td>
          <td><%= patient_record.handling_person %></td>
          <td>
            <%= link_to t('.view', :default => t("helpers.links.view")),
              patient_patient_record_path(@patient, patient_record), :class => 'btn btn-default btn-xs' %>
            <%= link_to t('.edit', :default => t("helpers.links.edit")),
              edit_patient_patient_record_path(@patient, patient_record), :class => 'btn btn-default btn-xs' %>
            <%= link_to t('.destroy', :default => t("helpers.links.destroy")),
              patient_patient_record_path(@patient, patient_record),
              :method => :delete,
              :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) },
              :class => 'btn btn-xs btn-danger' %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
<% end %>

<%= link_to t('.back', :default => t("helpers.links.back")),
  patients_path, :class => 'btn btn-default'  %>
<%= link_to t('.edit', :default => t("helpers.links.edit")),
  edit_patient_path(@patient), :class => 'btn btn-default' %>
<%= link_to t('.destroy', :default => t("helpers.links.destroy")),
  patient_path(@patient),
  :method => 'delete',
  :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) },
  :class => 'btn btn-danger' %>
<%= link_to 'New Record', new_patient_patient_record_path(@patient), :class => 'btn btn-default'  %>
